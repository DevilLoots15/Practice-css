<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Aviator - Pro Real</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-body: #000000;
            --bg-panel: #1b1c1d;
            --bg-input: #0f0f0f;
            --accent-red: #E91E63;
            --accent-green: #28a745;
            --accent-orange: #ff9800;
            --text-white: #ffffff;
            --text-grey: #9ca0a9;
            --border: #2c2d30;
        }

        * { box-sizing: border-box; user-select: none; -webkit-tap-highlight-color: transparent; }
        
        body {
            margin: 0;
            background-color: var(--bg-body);
            font-family: 'Roboto', sans-serif;
            color: var(--text-white);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* --- Header --- */
        .header {
            height: 54px;
            background: #1b1c1d;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            border-bottom: 1px solid var(--border);
            flex-shrink: 0;
            z-index: 20;
        }
        .logo { font-weight: 900; font-size: 20px; font-style: italic; letter-spacing: -1px; display:flex; align-items:center; gap:5px; }
        .logo span { color: var(--accent-red); }
        .balance-box { display: flex; flex-direction: column; align-items: flex-end; }
        .balance-val { color: var(--accent-green); font-weight: 700; font-size: 16px; }
        .balance-label { font-size: 10px; color: var(--text-grey); }

        .sound-toggle {
            background: none; border: 1px solid #333; color: #666;
            width: 30px; height: 30px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; margin-right: 10px;
        }
        .sound-toggle.active { color: var(--accent-green); border-color: var(--accent-green); }

        /* --- History Bar --- */
        .history-bar {
            height: 34px;
            background: #141516;
            display: flex;
            align-items: center;
            padding: 0 10px;
            gap: 6px;
            overflow: hidden;
            border-bottom: 1px solid #222;
            flex-shrink: 0;
        }
        .history-pill {
            background: #202124;
            color: #888;
            padding: 1px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 700;
            min-width: 36px;
            text-align: center;
        }
        .history-pill.blue { color: #34b4ff; background: rgba(52,180,255,0.1); }
        .history-pill.purple { color: #c017b4; background: rgba(192,23,180,0.1); }

        /* --- Main Layout --- */
        .main-layout {
            display: flex;
            flex-direction: column;
            flex: 1;
            height: 100%;
            overflow: hidden;
        }

        /* --- Stage (Canvas) --- */
        .stage-container {
            flex: 1; /* Takes remaining space on mobile */
            position: relative;
            background: #0f0f0f;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            border-bottom: 1px solid var(--border);
        }
        
        canvas { width: 100%; height: 100%; display: block; }

        .multiplier-display {
            position: absolute;
            top: 45%; left: 50%;
            transform: translate(-50%, -50%);
            font-size: 64px; font-weight: 900; color: white;
            z-index: 5; font-variant-numeric: tabular-nums;
            text-shadow: 0 0 30px rgba(0,0,0,0.5);
        }

        .flew-away-badge {
            position: absolute; top: 40%; left: 50%;
            transform: translate(-50%, -50%);
            display: none; flex-direction: column; align-items: center;
            z-index: 10;
        }
        .flew-away-text {
            font-size: 22px; font-weight: 700; color: var(--accent-red);
            text-transform: uppercase; margin-bottom: 5px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.8);
        }
        .flew-away-val { font-size: 58px; font-weight: 900; color: var(--accent-red); }

        .loader {
            position: absolute; top: 60%; left: 50%; transform: translate(-50%, -50%);
            display: none; flex-direction: column; align-items: center; gap: 8px;
        }
        .loader-bar-bg { width: 120px; height: 4px; background: #222; border-radius: 2px; overflow:hidden; }
        .loader-bar-fill { height:100%; background: var(--accent-red); width:0%; transition: width 0.05s linear; }

        /* --- Betting Section (Dual) --- */
        .betting-section {
            background: #141516;
            padding: 8px;
            display: flex;
            flex-direction: column; /* Mobile Default */
            gap: 8px;
            overflow-y: auto;
            max-height: 50%; /* Don't take up too much screen on mobile */
        }

        /* The Panel */
        .bet-panel {
            background: var(--bg-panel);
            border-radius: 8px;
            padding: 8px 12px;
            border: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            flex: 1;
            min-height: 120px;
        }
        .bet-panel.disabled { opacity: 0.6; pointer-events: none; }

        /* Top row of panel */
        .panel-header { display: flex; justify-content: space-between; margin-bottom: 6px; }
        .switch-tabs { background: #000; padding: 2px; border-radius: 12px; display: flex; }
        .tab { padding: 3px 12px; font-size: 10px; border-radius: 10px; color: #777; font-weight: 700; cursor: pointer; }
        .tab.active { background: #333; color: #fff; }

        /* Controls Row */
        .controls-row {
            display: grid;
            grid-template-columns: 1fr 110px; /* Input area vs Button */
            gap: 8px;
            height: 100%;
        }

        /* Input Area */
        .input-area { display: flex; flex-direction: column; justify-content: space-between; }
        .counter-input {
            display: flex; background: #000; border: 1px solid #333;
            border-radius: 4px; height: 34px; align-items: center; padding: 0 4px;
        }
        .btn-inc {
            width: 24px; height: 100%; background: transparent; border: none;
            color: #aaa; font-size: 16px; cursor: pointer;
        }
        .input-val {
            flex: 1; background: transparent; border: none; color: #fff;
            text-align: center; font-weight: 700; font-size: 14px; outline: none;
        }
        
        .presets { display: flex; gap: 4px; margin-top: 5px; }
        .preset-btn {
            flex: 1; background: #2c2d30; border: none; color: #fff;
            border-radius: 3px; font-size: 9px; padding: 4px 0; cursor: pointer;
        }

        /* Big Button */
        .main-btn {
            width: 100%; height: 100%; border-radius: 6px; border: none; cursor: pointer;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            box-shadow: 0 3px 0 rgba(0,0,0,0.3); position: relative;
            transition: transform 0.1s;
        }
        .main-btn:active { transform: translateY(2px); box-shadow: none; }
        
        .btn-green { background: var(--accent-green); }
        .btn-orange { background: var(--accent-orange); border: 1px solid rgba(255,255,255,0.2); }
        .btn-red { background: #d32f2f; }

        .btn-lbl { font-size: 15px; font-weight: 700; color: #fff; text-shadow: 0 1px 1px rgba(0,0,0,0.4); }
        .btn-sub { font-size: 10px; font-weight: 500; color: rgba(255,255,255,0.9); margin-top: 2px; }

        /* --- Desktop Responsive --- */
        @media (min-width: 900px) {
            .main-layout {
                flex-direction: row; /* Side by side stage and controls */
                padding: 20px;
                gap: 20px;
                background: #000;
            }
            .stage-container {
                border-radius: 12px;
                border: 1px solid var(--border);
            }
            .betting-section {
                width: 380px;
                flex-shrink: 0;
                background: transparent;
                border: none;
                padding: 0;
                overflow: visible;
                display: flex;
                flex-direction: column;
                gap: 15px;
            }
            .bet-panel {
                height: 140px;
            }
        }
    </style>
</head>
<body>

    <div class="header">
        <div class="logo">
            <div style="color:#E91E63; font-size: 24px;">âœˆ</div> 
            Aviator
        </div>
        <div style="display:flex; align-items:center;">
            <button class="sound-toggle" id="soundBtn">â™ª</button>
            <div class="balance-box">
                <span class="balance-val" id="totalBalance">5000.00</span>
                <span class="balance-label">INR</span>
            </div>
        </div>
    </div>

    <div class="history-bar" id="historyBar">
        <div style="color:#555; font-size:12px; cursor:pointer">ðŸ•’</div>
        </div>

    <div class="main-layout">
        
        <div class="stage-container">
            <canvas id="gameCanvas"></canvas>
            
            <div class="multiplier-display" id="bigMult">1.00x</div>
            
            <div class="flew-away-badge" id="crashBadge">
                <div class="flew-away-text">FLEW AWAY!</div>
                <div class="flew-away-val" id="crashVal">1.00x</div>
            </div>

            <div class="loader" id="loader">
                <div style="font-size: 11px; color: #888; letter-spacing: 1px;">WAITING FOR ROUND</div>
                <div class="loader-bar-bg"><div class="loader-bar-fill" id="loaderFill"></div></div>
            </div>
        </div>

        <div class="betting-section">
            
            <div class="bet-panel" id="panel1">
                <div class="panel-header">
                    <div class="switch-tabs">
                        <div class="tab active">Bet</div>
                        <div class="tab">Auto</div>
                    </div>
                </div>
                <div class="controls-row">
                    <div class="input-area">
                        <div class="counter-input">
                            <button class="btn-inc" onclick="game.adjBet(1, -10)">-</button>
                            <input type="number" id="betInput1" class="input-val" value="10">
                            <button class="btn-inc" onclick="game.adjBet(1, 10)">+</button>
                        </div>
                        <div class="presets">
                            <button class="preset-btn" onclick="game.setBet(1, 100)">100</button>
                            <button class="preset-btn" onclick="game.setBet(1, 200)">200</button>
                            <button class="preset-btn" onclick="game.setBet(1, 500)">500</button>
                            <button class="preset-btn" onclick="game.setBet(1, 1000)">1k</button>
                        </div>
                    </div>
                    <button class="main-btn btn-green" id="btn1" onclick="game.handleBtn(1)">
                        <div class="btn-lbl">BET</div>
                    </button>
                </div>
            </div>

            <div class="bet-panel" id="panel2">
                <div class="panel-header">
                    <div class="switch-tabs">
                        <div class="tab active">Bet</div>
                        <div class="tab">Auto</div>
                    </div>
                </div>
                <div class="controls-row">
                    <div class="input-area">
                        <div class="counter-input">
                            <button class="btn-inc" onclick="game.adjBet(2, -10)">-</button>
                            <input type="number" id="betInput2" class="input-val" value="50">
                            <button class="btn-inc" onclick="game.adjBet(2, 10)">+</button>
                        </div>
                        <div class="presets">
                            <button class="preset-btn" onclick="game.setBet(2, 100)">100</button>
                            <button class="preset-btn" onclick="game.setBet(2, 200)">200</button>
                            <button class="preset-btn" onclick="game.setBet(2, 500)">500</button>
                            <button class="preset-btn" onclick="game.setBet(2, 1000)">1k</button>
                        </div>
                    </div>
                    <button class="main-btn btn-green" id="btn2" onclick="game.handleBtn(2)">
                        <div class="btn-lbl">BET</div>
                    </button>
                </div>
            </div>

        </div>
    </div>

    <script>
        // --- Sound Engine (Web Audio API) ---
        class SoundManager {
            constructor() {
                this.ctx = null;
                this.enabled = false;
                this.engineOsc = null;
                this.engineGain = null;
            }

            init() {
                if(!this.ctx) {
                    this.ctx = new (window.AudioContext || window.webkitAudioContext)();
                }
                if(this.ctx.state === 'suspended') {
                    this.ctx.resume();
                }
                this.enabled = true;
            }

            toggle() {
                if(this.enabled) {
                    this.stopEngine();
                    this.enabled = false;
                    return false;
                } else {
                    this.init();
                    return true;
                }
            }

            // Engine Drone
            startEngine() {
                if(!this.enabled) return;
                this.stopEngine();
                
                this.engineOsc = this.ctx.createOscillator();
                this.engineOsc.type = 'sawtooth';
                this.engineOsc.frequency.value = 80; // Start low pitch

                this.engineGain = this.ctx.createGain();
                this.engineGain.gain.value = 0.05; // Low volume

                // Lowpass filter to muffle it
                const filter = this.ctx.createBiquadFilter();
                filter.type = 'lowpass';
                filter.frequency.value = 400;

                this.engineOsc.connect(filter);
                filter.connect(this.engineGain);
                this.engineGain.connect(this.ctx.destination);
                
                this.engineOsc.start();
            }

            updateEngine(mult) {
                if(!this.enabled || !this.engineOsc) return;
                // Pitch rises with multiplier
                const pitch = 80 + (mult * 20); 
                this.engineOsc.frequency.setTargetAtTime(Math.min(pitch, 600), this.ctx.currentTime, 0.1);
            }

            stopEngine() {
                if(this.engineOsc) {
                    this.engineOsc.stop();
                    this.engineOsc.disconnect();
                    this.engineOsc = null;
                }
            }

            // FX
            playDing() {
                if(!this.enabled) return;
                const osc = this.ctx.createOscillator();
                const gain = this.ctx.createGain();
                osc.type = 'sine';
                osc.frequency.setValueAtTime(1200, this.ctx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(600, this.ctx.currentTime + 0.3);
                gain.gain.setValueAtTime(0.3, this.ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + 0.3);
                osc.connect(gain);
                gain.connect(this.ctx.destination);
                osc.start();
                osc.stop(this.ctx.currentTime + 0.3);
            }

            playCrash() {
                if(!this.enabled) return;
                // White noise burst
                const bufferSize = this.ctx.sampleRate * 0.5; // 0.5 sec
                const buffer = this.ctx.createBuffer(1, bufferSize, this.ctx.sampleRate);
                const data = buffer.getChannelData(0);
                for(let i=0; i<bufferSize; i++) data[i] = Math.random() * 2 - 1;

                const noise = this.ctx.createBufferSource();
                noise.buffer = buffer;
                const gain = this.ctx.createGain();
                gain.gain.setValueAtTime(0.2, this.ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + 0.5);
                
                noise.connect(gain);
                gain.connect(this.ctx.destination);
                noise.start();
            }
        }
        
        const audio = new SoundManager();

        // --- Game Engine ---
        class AviatorGame {
            constructor() {
                this.canvas = document.getElementById('gameCanvas');
                this.ctx = this.canvas.getContext('2d');
                this.balance = 5000.00;
                
                // Betting State for 2 panels
                this.bets = {
                    1: { val: 10, placed: false, active: false, input: document.getElementById('betInput1'), btn: document.getElementById('btn1') },
                    2: { val: 50, placed: false, active: false, input: document.getElementById('betInput2'), btn: document.getElementById('btn2') }
                };

                this.state = 'IDLE'; // IDLE, LOADING, FLYING, CRASHED
                this.mult = 1.00;
                this.crashPoint = 1.00;
                this.startTime = 0;
                this.stars = [];
                
                // Asset: Plane SVG Base64
                this.planeImg = new Image();
                this.planeImg.src = `data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9IiNFOTFFNjMiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTIxIDE2djQtMmwtOC01VjdsOCA1em0tMTAgNHYtM2w0IDN2M3ptLTggNHYtMmwyLTF2M2wtMiAweiIvPjwvc3ZnPg==`;

                this.resize();
                window.addEventListener('resize', ()=>this.resize());
                this.initStars();
                this.updateUI();

                // Start Loop
                this.startLoading();
            }

            resize() {
                const rect = this.canvas.parentElement.getBoundingClientRect();
                this.canvas.width = rect.width;
                this.canvas.height = rect.height;
                this.width = rect.width;
                this.height = rect.height;
            }

            initStars() {
                for(let i=0; i<60; i++) {
                    this.stars.push({
                        x: Math.random() * this.width,
                        y: Math.random() * this.height,
                        s: Math.random() * 2,
                        v: 1 + Math.random() * 3
                    });
                }
            }

            // -- Input Logic --
            adjBet(id, delta) {
                let v = Number(this.bets[id].input.value) + delta;
                if(v < 1) v = 1;
                this.bets[id].input.value = v;
                this.updateBtn(id);
            }
            setBet(id, val) {
                this.bets[id].input.value = val;
                this.updateBtn(id);
            }

            handleBtn(id) {
                const bet = this.bets[id];
                const amount = Number(bet.input.value);

                // Init audio on first interaction
                if(!audio.ctx) audio.init();

                if(this.state === 'FLYING') {
                    if(bet.active) {
                        // CASHOUT
                        this.cashOut(id);
                    } else if (!bet.placed) {
                        // BET NEXT
                        if(this.balance < amount) return;
                        this.balance -= amount;
                        bet.val = amount;
                        bet.placed = true;
                    } else {
                        // CANCEL NEXT
                        this.balance += bet.val;
                        bet.placed = false;
                    }
                } else {
                    // IDLE/LOADING phase
                    if(!bet.placed) {
                        // BET
                        if(this.balance < amount) return;
                        this.balance -= amount;
                        bet.val = amount;
                        bet.placed = true;
                    } else {
                        // CANCEL
                        this.balance += bet.val;
                        bet.placed = false;
                    }
                }
                this.updateUI();
            }

            cashOut(id) {
                const bet = this.bets[id];
                if(!bet.active) return;
                
                const win = bet.val * this.mult;
                this.balance += win;
                bet.active = false;
                bet.placed = false;
                
                audio.playDing();
                
                // Update Button to Show Win
                const btn = bet.btn;
                btn.className = 'main-btn btn-green';
                btn.innerHTML = `<div class="btn-lbl">WON ${win.toFixed(2)}</div>`;
                
                // Revert button after delay
                setTimeout(()=> this.updateBtn(id), 2000);
                this.updateUI();
            }

            updateUI() {
                document.getElementById('totalBalance').textContent = this.balance.toFixed(2);
                this.updateBtn(1);
                this.updateBtn(2);
            }

            updateBtn(id) {
                const bet = this.bets[id];
                const btn = bet.btn;
                const amt = Number(bet.input.value);

                // If currently showing a "Win" message, skip update
                if(btn.innerText.includes('WON')) return;

                if(this.state === 'FLYING' && bet.active) {
                    btn.className = 'main-btn btn-orange';
                    const winAmt = (bet.val * this.mult).toFixed(2);
                    btn.innerHTML = `<div class="btn-lbl">CASH OUT</div><div class="btn-sub">${winAmt}</div>`;
                } else if (bet.placed) {
                    btn.className = 'main-btn btn-red';
                    if(this.state === 'FLYING') {
                         btn.innerHTML = `<div class="btn-lbl">WAITING</div><div class="btn-sub">NEXT ROUND</div>`;
                    } else {
                        btn.innerHTML = `<div class="btn-lbl">WAITING</div><div class="btn-sub">CANCEL</div>`;
                    }
                } else {
                    btn.className = 'main-btn btn-green';
                    btn.innerHTML = `<div class="btn-lbl">BET</div><div class="btn-sub">${amt.toFixed(2)} INR</div>`;
                }
            }

            // -- Game Loops --
            startLoading() {
                this.state = 'LOADING';
                this.mult = 1.00;
                document.getElementById('bigMult').style.display = 'none';
                document.getElementById('crashBadge').style.display = 'none';
                document.getElementById('loader').style.display = 'flex';
                
                this.updateUI();
                audio.stopEngine();

                let progress = 0;
                const int = setInterval(() => {
                    progress += 2;
                    document.getElementById('loaderFill').style.width = progress + '%';
                    this.drawBackground(0.5); // Slow stars
                    if(progress >= 100) {
                        clearInterval(int);
                        this.startFlight();
                    }
                }, 50); // 2.5s load time
            }

            startFlight() {
                this.state = 'FLYING';
                document.getElementById('loader').style.display = 'none';
                document.getElementById('bigMult').style.display = 'block';
                
                // Activate placed bets
                [1,2].forEach(id => {
                    if(this.bets[id].placed) {
                        this.bets[id].active = true;
                    }
                });

                this.startTime = Date.now();
                this.crashPoint = this.getCrashPoint();
                audio.startEngine();
                
                requestAnimationFrame(() => this.loop());
            }

            loop() {
                if(this.state !== 'FLYING') return;

                const elapsed = Date.now() - this.startTime;
                // E = time in seconds. Formula: M = 1 + (0.06 * t + 0.04 * t^2) approx
                const t = elapsed / 1000;
                this.mult = 1.0 + (0.06 * t) + (0.05 * t * t);
                
                // Update DOM
                document.getElementById('bigMult').textContent = this.mult.toFixed(2) + 'x';
                this.updateUI(); // Updates cashout buttons
                audio.updateEngine(this.mult);

                // Draw
                this.drawBackground(this.mult);
                this.drawCurve(this.mult);

                // Crash?
                if(this.mult >= this.crashPoint) {
                    this.crash();
                } else {
                    requestAnimationFrame(() => this.loop());
                }
            }

            crash() {
                this.state = 'CRASHED';
                audio.stopEngine();
                audio.playCrash();

                document.getElementById('bigMult').style.display = 'none';
                document.getElementById('crashBadge').style.display = 'flex';
                document.getElementById('crashVal').textContent = this.mult.toFixed(2) + 'x';
                
                this.addHistory(this.mult);

                // Clear active bets (Losses)
                [1,2].forEach(id => {
                    if(this.bets[id].active) {
                        this.bets[id].active = false;
                        this.bets[id].placed = false;
                    }
                });
                this.updateUI();

                setTimeout(() => this.startLoading(), 3000);
            }

            getCrashPoint() {
                // Skewed distribution
                const r = Math.random();
                // 1% chance of instant crash (1.00x)
                if(r < 0.01) return 1.00;
                // Inverse probability
                const c = 0.99 / (1 - r);
                return Math.max(1.00, Math.min(c, 500));
            }

            addHistory(val) {
                const bar = document.getElementById('historyBar');
                const el = document.createElement('div');
                let color = '';
                if(val >= 10) color = 'purple';
                else if(val >= 2) color = 'blue';
                el.className = `history-pill ${color}`;
                el.textContent = val.toFixed(2) + 'x';
                bar.insertBefore(el, bar.children[1]);
                if(bar.children.length > 20) bar.lastChild.remove();
            }

            // -- Drawing --
            drawBackground(speed) {
                this.ctx.fillStyle = '#0f0f0f';
                this.ctx.fillRect(0, 0, this.width, this.height);
                
                // Draw Grid
                this.ctx.strokeStyle = '#222';
                this.ctx.lineWidth = 1;
                this.ctx.beginPath();
                for(let y=0; y<this.height; y+=60) {
                    this.ctx.moveTo(0, y); this.ctx.lineTo(this.width, y);
                }
                for(let x=0; x<this.width; x+=60) {
                    this.ctx.moveTo(x, 0); this.ctx.lineTo(x, this.height);
                }
                this.ctx.stroke();

                // Draw Stars
                this.ctx.fillStyle = '#666';
                this.stars.forEach(s => {
                    this.ctx.beginPath();
                    this.ctx.arc(s.x, s.y, s.s, 0, Math.PI*2);
                    this.ctx.fill();
                    s.x -= s.v * (speed > 1 ? speed * 0.5 : 0.5);
                    if(s.x < 0) { s.x = this.width; s.y = Math.random() * this.height; }
                });
            }

            drawCurve(m) {
                // We want the plane to rise to the middle-right area and stay there while background moves
                // But visually it looks better if it "takes off" from bottom left first.
                
                const w = this.width;
                const h = this.height;
                
                // Normalise launch: 0 to 1 over first 4 seconds (approx 5x)
                const phase = Math.min((m - 1) / 3, 1); 

                // Coordinates
                const startX = 0;
                const startY = h;
                
                // Target spot (20% from right, 20% from top)
                const targetX = w * 0.8;
                const targetY = h * 0.2;

                const curX = startX + (targetX - startX) * phase;
                const curY = startY + (targetY - startY) * phase;

                // Bezier Control Point
                const cpX = curX * 0.6;
                const cpY = h;

                // Gradient Fill
                const grad = this.ctx.createLinearGradient(0, 0, 0, h);
                grad.addColorStop(0, 'rgba(233, 30, 99, 0.4)');
                grad.addColorStop(1, 'rgba(233, 30, 99, 0)');

                this.ctx.beginPath();
                this.ctx.moveTo(0, h);
                this.ctx.quadraticCurveTo(cpX, h, curX, curY);
                this.ctx.lineTo(curX, h);
                this.ctx.lineTo(0, h);
                this.ctx.fillStyle = grad;
                this.ctx.fill();

                // Stroke
                this.ctx.beginPath();
                this.ctx.moveTo(0, h);
                this.ctx.quadraticCurveTo(cpX, h, curX, curY);
                this.ctx.lineWidth = 5;
                this.ctx.strokeStyle = '#E91E63';
                this.ctx.lineCap = 'round';
                this.ctx.stroke();

                // Plane
                const size = 50;
                this.ctx.save();
                this.ctx.translate(curX, curY);
                // Rotate slightly based on ascent
                const angle = phase < 1 ? -15 * Math.PI / 180 : 0;
                this.ctx.rotate(angle);
                this.ctx.drawImage(this.planeImg, -size, -size/1.5, size*1.5, size*1.5);
                this.ctx.restore();
            }
        }

        // Init
        const game = new AviatorGame();
        
        // Sound Toggle Handler
        const soundBtn = document.getElementById('soundBtn');
        soundBtn.addEventListener('click', () => {
            const isActive = audio.toggle();
            soundBtn.textContent = isActive ? 'ðŸ”Š' : 'ðŸ”‡';
            soundBtn.classList.toggle('active', isActive);
        });

    </script>
</body>
</html>
